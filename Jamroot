
import testing ;
import os ;

rule subdir-run ( subdir : cpp_fname : requirements * )
{
    run $(subdir)/$(cpp_fname).cpp : : : <include>$(subdir) $(requirements) :
            $(subdir)-$(cpp_fname) ;
}

rule subdir-compile-fail ( subdir : cpp_fname : requirements * )
{
    compile-fail $(subdir)/$(cpp_fname).cpp :
            <include>$(subdir) $(requirements) : $(subdir)-$(cpp_fname) ;
}

if ! [ os.environ BOOST_ROOT ] {
    exit "Error: Set BOOST_ROOT environment variable to Boost root directory" ;
}
local BOOST_ROOT = [ os.environ BOOST_ROOT ] ;

echo "Build Boost.Contract's source, tests, examples, documentation, etc." ;
echo "Using Boost libraries from (see $BOOST_ROOT): $(BOOST_ROOT)" ;
echo ;

use-project boost : $(BOOST_ROOT) ;

project
    :   requirements
        <toolset>gcc:<cxxflags>-std=c++11
        <toolset>clang:<cxxflags>-std=c++11
        <include>"./include"
        <include>$(BOOST_ROOT)
        <library-path>$(BOOST_ROOT)/stage/lib
    ;

