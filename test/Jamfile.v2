
subdir-usage ;

test-suite constructor
:
    [ subdir-run-withno constructor : decl_pre_all ]
    [ subdir-run-withno constructor : decl_pre_ends ]
    [ subdir-run-withno constructor : decl_pre_mid ]
    [ subdir-run-withno constructor : decl_pre_none ]
    
    [ subdir-run-withno constructor : decl_post_all ]
    [ subdir-run-withno constructor : decl_post_ends ]
    [ subdir-run-withno constructor : decl_post_mid ]
    [ subdir-run-withno constructor : decl_post_none ]
    
    [ subdir-run-withno constructor : decl_entry_static_inv_all ]
    [ subdir-run-withno constructor : decl_entry_static_inv_ends ]
    [ subdir-run-withno constructor : decl_entry_static_inv_mid ]
    [ subdir-run-withno constructor : decl_entry_static_inv_none ]
    
    [ subdir-run-withno constructor : decl_exit_static_inv_all ]
    [ subdir-run-withno constructor : decl_exit_static_inv_ends ]
    [ subdir-run-withno constructor : decl_exit_static_inv_mid ]
    [ subdir-run-withno constructor : decl_exit_static_inv_none ]
    
    # No decl_entry_static_inv_... for constructors.

    [ subdir-run-withno constructor : decl_exit_inv_all ]
    [ subdir-run-withno constructor : decl_exit_inv_ends ]
    [ subdir-run-withno constructor : decl_exit_inv_mid ]
    [ subdir-run-withno constructor : decl_exit_inv_none ]
    
    [ subdir-run-withno constructor : bases ]
    [ subdir-run-withno constructor : access ]
    [ subdir-run-withno constructor : no_contracts ]

    [ subdir-run-withno constructor : body_throw ]
    [ subdir-run-withno constructor : old_throw ]
    
    [ subdir-compile-fail constructor : pre_error ]
;

test-suite destructor
:
    # No decl_pre_... for destructors.
    
    [ subdir-run-withno destructor : decl_post_all ]
    [ subdir-run-withno destructor : decl_post_ends ]
    [ subdir-run-withno destructor : decl_post_mid ]
    [ subdir-run-withno destructor : decl_post_none ]
    
    [ subdir-run-withno destructor : decl_entry_static_inv_all ]
    [ subdir-run-withno destructor : decl_entry_static_inv_ends ]
    [ subdir-run-withno destructor : decl_entry_static_inv_mid ]
    [ subdir-run-withno destructor : decl_entry_static_inv_none ]
    
    [ subdir-run-withno destructor : decl_exit_static_inv_all ]
    [ subdir-run-withno destructor : decl_exit_static_inv_ends ]
    [ subdir-run-withno destructor : decl_exit_static_inv_mid ]
    [ subdir-run-withno destructor : decl_exit_static_inv_none ]
    
    [ subdir-run-withno destructor : decl_entry_inv_all ]
    [ subdir-run-withno destructor : decl_entry_inv_ends ]
    [ subdir-run-withno destructor : decl_entry_inv_mid ]
    [ subdir-run-withno destructor : decl_entry_inv_none ]

    # No decl_exit_inv_... for destructors.

    [ subdir-run-withno destructor : bases ]
    [ subdir-run-withno destructor : access ]
    [ subdir-run-withno destructor : no_contracts ]

    [ subdir-run-withno destructor : body_throw ]
    [ subdir-run-withno destructor : old_throw ]

    [ subdir-compile-fail destructor : pre_error ]
;

test-suite public_function
:
    [ subdir-run-withno public_function : decl_pre_all ]
    [ subdir-run-withno public_function : decl_pre_ends ]
    [ subdir-run-withno public_function : decl_pre_mid ]
    [ subdir-run-withno public_function : decl_pre_none ]

    [ subdir-run-withno public_function : decl_post_all ]
    [ subdir-run-withno public_function : decl_post_ends ]
    [ subdir-run-withno public_function : decl_post_mid ]
    [ subdir-run-withno public_function : decl_post_none ]
    
    [ subdir-run-withno public_function : decl_entry_static_inv_all ]
    [ subdir-run-withno public_function : decl_entry_static_inv_ends ]
    [ subdir-run-withno public_function : decl_entry_static_inv_mid ]
    [ subdir-run-withno public_function : decl_entry_static_inv_none ]
    
    [ subdir-run-withno public_function : decl_exit_static_inv_all ]
    [ subdir-run-withno public_function : decl_exit_static_inv_ends ]
    [ subdir-run-withno public_function : decl_exit_static_inv_mid ]
    [ subdir-run-withno public_function : decl_exit_static_inv_none ]
    
    [ subdir-run-withno public_function : decl_entry_inv_all ]
    [ subdir-run-withno public_function : decl_entry_inv_ends ]
    [ subdir-run-withno public_function : decl_entry_inv_mid ]
    [ subdir-run-withno public_function : decl_entry_inv_none ]
    
    [ subdir-run-withno public_function : decl_exit_inv_all ]
    [ subdir-run-withno public_function : decl_exit_inv_ends ]
    [ subdir-run-withno public_function : decl_exit_inv_mid ]
    [ subdir-run-withno public_function : decl_exit_inv_none ]
    
    [ subdir-run-withno public_function : bases ]
    [ subdir-run-withno public_function : bases_virtual ]
    [ subdir-run-withno public_function : bases_branch ]
    [ subdir-run-withno public_function : bases_sparse ]
    
    [ subdir-run-withno public_function : access ]
    [ subdir-run-withno public_function : no_contracts ]
    
    [ subdir-run-withno public_function : body_throw ]
    [ subdir-run-withno public_function : old_throw ]

    [ subdir-run-withno public_function : static ]
    [ subdir-run-withno public_function : static_body_throw ]
    [ subdir-run-withno public_function : static_old_throw ]
    [ subdir-run-withno public_function : static_no_contracts ]

    [ subdir-compile-fail public_function : override_error ]
    [ subdir-run-withno public_function : override_permissive ]
;

test-suite function
:
    [ subdir-run-withno function : decl_pre_all ]
    [ subdir-run-withno function : decl_pre_none ]
    
    [ subdir-run-withno function : decl_post_all ]
    [ subdir-run-withno function : decl_post_none ]
    
    [ subdir-run-withno function : func ]
    [ subdir-run-withno function : no_contracts ]

    [ subdir-run-withno function : body_throw ]
    [ subdir-run-withno function : old_throw ]
;

test-suite invariant
:
    [ subdir-run-withno invariant : all_static_cv_const ]
    [ subdir-run-withno invariant : both_static_cv ]
    [ subdir-run-withno invariant : both_cv_const ]
    [ subdir-run-withno invariant : both_static_const ]
    [ subdir-run-withno invariant : only_static ]
    [ subdir-run-withno invariant : only_cv ]
    [ subdir-run-withno invariant : only_const ]
    [ subdir-run-withno invariant : no_inv ]

    [ subdir-compile-fail invariant : static_inv_mutable_error ]
    [ subdir-run-withno invariant : static_inv_mutable_permissive ]
    [ subdir-compile-fail invariant : static_inv_const_error ]
    [ subdir-run-withno invariant : static_inv_const_permissive ]
    [ subdir-compile-fail invariant : static_inv_volatile_error ]
    [ subdir-run-withno invariant : static_inv_volatile_permissive ]
    [ subdir-compile-fail invariant : static_inv_cv_error ]
    [ subdir-run-withno invariant : static_inv_cv_permissive ]
    
    [ subdir-compile-fail invariant : inv_static_error ]
    [ subdir-run-withno invariant : inv_static_permissive ]
    [ subdir-compile-fail invariant : inv_mutable_error ]
    [ subdir-run-withno invariant : inv_mutable_permissive ]
    [ subdir-compile-fail invariant : inv_volatile_error ]
    [ subdir-run-withno invariant : inv_volatile_permissive ]
;
    
test-suite result
:
    [ subdir-run-withno result : mixed_optional ]
    [ subdir-run-withno result : mixed_optional_ref ]

    [ subdir-compile-fail result : type_mismatch_error ]
;

test-suite old
:
    [ subdir-run-withno old : auto ]

    [ subdir-run-withno old : no_macros ]
    [ subdir-compile-fail old : no_make_old_error ]

    [ subdir-run-withno old : noncopyable ]
    [ subdir-compile-fail old : noncopyable_error ]
    
    [ subdir-run-withno old : no_equal ]
    [ subdir-compile-fail old : no_equal_error ]
;

test-suite disable
:
    [ subdir-run-withno disable : checking ]
;

test-suite set
:
    [ subdir-run-withno set : all_pre_old_post ]
    [ subdir-run-withno set : both_pre_old ]
    [ subdir-run-withno set : both_old_post ]
    [ subdir-run-withno set : both_pre_post ]
    [ subdir-run-withno set : only_pre ]
    [ subdir-run-withno set : only_old ]
    [ subdir-run-withno set : only_post ]
    [ subdir-run-withno set : nothing ]
    
    [ subdir-run-withno set : no_guard ]

    [ subdir-compile-fail set : old_pre_error ]
    [ subdir-compile-fail set : post_old_error ]
    [ subdir-compile-fail set : post_pre_error ]
;

test-suite call_if
:
    [ subdir-run call_if : true_ ]
    [ subdir-run call_if : false_ ]

    [ subdir-run call_if : true_void ]
    [ subdir-run call_if : false_void ]
    
    [ subdir-run call_if : equal_to ]
;

# C++14 supported only by Clang... so in its own suite and explicit.
test-suite cxx14
:
    [ subdir-run call_if : equal_to_cxx14 :
            <toolset>clang:<cxxflags>-std=c++1y ]
    [ subdir-run call_if : advance_cxx14 :
            <toolset>clang:<cxxflags>-std=c++1y ]
;
explicit cxx14 ;

