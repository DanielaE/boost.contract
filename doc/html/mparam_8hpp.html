<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>dbc/mparam.hpp File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.5 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>dbc/mparam.hpp File Reference</h1>Header to only include facility to support commas in macro parameters. <a href="#_details">More...</a>
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="mparam_8hpp.html#8ee8cdd53b9cc3060ecef82fc02a8a4a">DBC_MPARAM</a>(token_count, parenthesised_param)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This macro is used to pass macro parameters containing commas.  <a href="#8ee8cdd53b9cc3060ecef82fc02a8a4a"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Header to only include facility to support commas in macro parameters. 
<p>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="8ee8cdd53b9cc3060ecef82fc02a8a4a"></a><!-- doxytag: member="mparam.hpp::DBC_MPARAM" ref="8ee8cdd53b9cc3060ecef82fc02a8a4a" args="(token_count, parenthesised_param)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DBC_MPARAM          </td>
          <td>(</td>
          <td class="paramtype">token_count,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">parenthesised_param&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This macro is used to pass macro parameters containing commas. 
<p>
The C++ preprocessor only recognize the <code>()</code> parenthesis. Other parenthesis like <code>&lt;&gt;</code> for templates, <code>{}</code> for code blocks, <code>[]</code> for indexing, etc are <em>not</em> recognized by the preprocessor so they do not wrap their expressions when used within macro parameters. This macro can be used to overcome this limitation.<p>
For example, say that you have to pass to <code><a class="el" href="object_8hpp.html#126883cfec96cafb25d481c5b1e6df61" title="This macro must follow the class type name and it privately derives the class from...">DBC_INHERIT_OBJECT()</a></code> a class type which is a template with two arguments. The following will <em>not</em> work: <div class="fragment"><pre class="fragment"><span class="preprocessor">  #include &lt;<a class="code" href="dbc_8hpp.html" title="Header file to include the entire Design By Contract for C++ library.">dbc.hpp</a>&gt;</span>
  
  <span class="keyword">template</span>&lt;<span class="keyword">typename</span> K, <span class="keyword">typename</span> T&gt;
  <span class="keyword">class </span>C <a class="code" href="object_8hpp.html#126883cfec96cafb25d481c5b1e6df61" title="This macro must follow the class type name and it privately derives the class from...">DBC_INHERIT_OBJECT</a>(C&lt;K, T&gt;) { ... }; <span class="comment">// No, two macro parameters.</span>
</pre></div> The issue is that the preprocessor does not recognize the <code>&lt;&gt;</code> parenthesis so the macro parameter <code>C&lt;K, T&gt;</code> is interpreted by the preprocessor as two separate tokens <code>C&lt;K</code> and <code>T&gt;</code> separated by the comma. In this case the compiler will generate an error saying that you passed two parameters to the <code><a class="el" href="object_8hpp.html#126883cfec96cafb25d481c5b1e6df61" title="This macro must follow the class type name and it privately derives the class from...">DBC_INHERIT_OBJECT()</a></code> macro that takes one parameter instead. <br>
 Because the preprocessor recognizes the <code>()</code> parenthesis, it might be tempted to overcome this issue simply by wrapping the macro parameter within <code>()</code> parenthesis: <div class="fragment"><pre class="fragment"><span class="preprocessor">  #include &lt;<a class="code" href="dbc_8hpp.html" title="Header file to include the entire Design By Contract for C++ library.">dbc.hpp</a>&gt;</span>
  
  <span class="keyword">template</span>&lt;<span class="keyword">typename</span> K, <span class="keyword">typename</span> T&gt;
  <span class="keyword">class </span>C <a class="code" href="object_8hpp.html#126883cfec96cafb25d481c5b1e6df61" title="This macro must follow the class type name and it privately derives the class from...">DBC_INHERIT_OBJECT</a>( (C&lt;K, T&gt;) ) { ... }; <span class="comment">// No type, only as value.</span>
</pre></div> In this case one parameter <code>(C&lt;K, T&gt;)</code> (and not two) is passed to the macro. However, because of the extra parenthesis <code>()</code> around the parameter, this time the C++ compiler (and not the preprocessor) will error when evaluating this expression in a context where a type is expected (note that this is instead a sufficient approach is the macro parameter represents a value and not a type, but unfortunately that is not the case for <code><a class="el" href="object_8hpp.html#126883cfec96cafb25d481c5b1e6df61" title="This macro must follow the class type name and it privately derives the class from...">DBC_INHERIT_OBJECT()</a></code> for which the parameter represents a type). <br>
 We need a way to strip the extra parenthesis <code>()</code> after they have been used to pass the parameter as a single parameter. This is done by this macro using the extra information of how many preprocessor tokens are contained within the parenthesis (two in this example). The following will work: <div class="fragment"><pre class="fragment"><span class="preprocessor">  #include &lt;<a class="code" href="dbc_8hpp.html" title="Header file to include the entire Design By Contract for C++ library.">dbc.hpp</a>&gt;</span>
  
  <span class="keyword">template</span>&lt;<span class="keyword">typename</span> K, <span class="keyword">typename</span> T&gt;
  <span class="keyword">class </span>C <a class="code" href="object_8hpp.html#126883cfec96cafb25d481c5b1e6df61" title="This macro must follow the class type name and it privately derives the class from...">DBC_INHERIT_OBJECT</a>( <a class="code" href="mparam_8hpp.html#8ee8cdd53b9cc3060ecef82fc02a8a4a" title="This macro is used to pass macro parameters containing commas.">DBC_MPARAM</a>(2, (C&lt;K, T&gt;) ) ) { ... }; <span class="comment">// OK.</span>
</pre></div><p>
Similar considerations apply if commas are used within code block parenthesis <code>{}</code>. Note that when calling functions from code blocks, commas separating the function arguments are always wrapped by <code>()</code> so there is no issue. However, is you are instantiating a template with more than one parameter in a code block you will need to use this macro. For example: <div class="fragment"><pre class="fragment"><span class="preprocessor">  #include &lt;<a class="code" href="dbc_8hpp.html" title="Header file to include the entire Design By Contract for C++ library.">dbc.hpp</a>&gt;</span>
  ...
      <a class="code" href="invariant_8hpp.html#fd939e7c1754a61a57c20bb7c6422ed4" title="This macro must be used within the class declaration and it specifies the invariants...">DBC_INVARIANT</a>(C, {
          f(1, 2); <span class="comment">// OK, as the comma wrapped within () because of fun call.</span>
          std::map&lt;int, float&gt; m; <span class="comment">// No, two macro parameters.</span>
          ...
      })
</pre></div> will <em>not</em> work as the code block parameter is interpreted by the preprocessor are two separate tokens <code>{ f(1, 2); sts::map&lt;int</code> and <code>float&gt; m; ... }</code> because of the comma in the <code>std::map</code> template instantiation. This will work: <div class="fragment"><pre class="fragment"><span class="preprocessor">  #include &lt;<a class="code" href="dbc_8hpp.html" title="Header file to include the entire Design By Contract for C++ library.">dbc.hpp</a>&gt;</span>
  ...
      <a class="code" href="invariant_8hpp.html#fd939e7c1754a61a57c20bb7c6422ed4" title="This macro must be used within the class declaration and it specifies the invariants...">DBC_INVARIANT</a>(C, <a class="code" href="mparam_8hpp.html#8ee8cdd53b9cc3060ecef82fc02a8a4a" title="This macro is used to pass macro parameters containing commas.">DBC_MPARAM</a>(2, ({ <span class="comment">// OK.</span>
          f(1, 2);
          std::map&lt;int, float&gt; m;
          ...
      })))
</pre></div> Note, the extra parenthesis <code>()</code> wrapping the code block <code>{ ... }</code> passed to <code><a class="el" href="mparam_8hpp.html#8ee8cdd53b9cc3060ecef82fc02a8a4a" title="This macro is used to pass macro parameters containing commas.">DBC_MPARAM()</a></code>.<p>
Similar considerations apply when using any other parenthesis different from <code>()</code> within a macro parameter. <small></small><p>
<small> <dl class="note" compact><dt><b>Note:</b></dt><dd>This limitation has to do simply with how the C++ preprocessor works and it is not introduced by this library. If new revisions of the C++ standard were to support <em>variadic</em> macros [<a class="el" href="Bibliography.html#Nel04">Nel04</a>], this limitation could be overcome in different ways and the need for the <code><a class="el" href="mparam_8hpp.html#8ee8cdd53b9cc3060ecef82fc02a8a4a" title="This macro is used to pass macro parameters containing commas.">DBC_MPARAM()</a></code> macro could be revisited.</dd></dl>
</small> <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>token_count</em>&nbsp;</td><td>The number of tokens contained in <em>parenthesised_param</em> as recognized by the preprocessor. This number cannot be negative and there is no need to use this macro with a count less than 2 (because the preprocessor can deal directly with no-token or a single-token macro parameters). </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>parenthesised_param</em>&nbsp;</td><td>The tokens that should be threated as a single macro parameter wrapped within extra parenthesis <code>()</code>. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Pass the specified tokens as a single macro parameter. </dd></dl>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Sat Nov 21 11:16:02 2009 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.5 </small></address>
</body>
</html>
